{"data":{"site":{"siteMetadata":{"title":"warizz.io","author":"Warizz Yutanan"}},"markdownRemark":{"id":"3e99d131-7315-5c49-8821-92044381f3ac","excerpt":"I often found components were exported like this which look very confusing. My colleague made something like this which is a lot better than above. From the…","fields":{"slug":"/react-cleaner-way-to-compose-components/"},"html":"<p>I often found components were exported like this which look very confusing.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">...</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token function\">withRouter</span><span class=\"token punctuation\">(</span><span class=\"token function\">translate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'common'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>Component<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>My colleague made something like this which is a lot better than above.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> HOCs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  withRouter<span class=\"token punctuation\">,</span>\n  <span class=\"token function\">translate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'common'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> ComponentWithHoc <span class=\"token operator\">=</span> HOCs<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">b</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> MainComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>From the idea, I made a function for reusable purpose.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">compose</span><span class=\"token punctuation\">(</span>baseComponent<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> args<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">b</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> baseComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Usage</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">compose</span><span class=\"token punctuation\">(</span>\n  BaseComponent<span class=\"token punctuation\">,</span> <span class=\"token comment\">// base</span>\n  <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 3rd</span>\n  withRouter<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 2nd</span>\n  <span class=\"token function\">translate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'common'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 1st</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>This approach looks cleaner but a little bit weird because of the flow of composing that start from the first argument then goes to last then the one before last and so on.</p>\n<p>One day while surfing the interweb, I stumbled upon a topic and found out that we can use Array’s <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduceRight\"><code class=\"language-text\">reduceRight</code></a> function (I didn’t even know it exists!) to make the flow more natural.</p>\n<p>So the final result would be.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">compose</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> args<span class=\"token punctuation\">.</span><span class=\"token function\">reduceRight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>acc<span class=\"token punctuation\">,</span> current<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">current</span><span class=\"token punctuation\">(</span>acc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Usage</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">compose</span><span class=\"token punctuation\">(</span>\n  <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 3rd</span>\n  withRouter<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 2nd</span>\n  <span class=\"token function\">translate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'common'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 1st</span>\n  BaseComponent<span class=\"token punctuation\">,</span> <span class=\"token comment\">// base</span>\n<span class=\"token punctuation\">)</span></code></pre></div>","frontmatter":{"title":"Cleaner way to compose components","date":"January 03, 2019","lang":null,"langs":null}}},"pageContext":{"slug":"/react-cleaner-way-to-compose-components/","previous":{"fields":{"slug":"/best-of-2018/"},"frontmatter":{"title":"Best of 2018","lang":null}},"next":{"fields":{"slug":"/reading-other-people-code-ep-1/"},"frontmatter":{"title":"Reading other people's code episode 1: _.get","lang":null}}}}